
<!DOCTYPE html>
<html lang="en" class="dark light">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="base" content="https://zhuzaiye.github.io/">

    
    

    
    
        <title>Docxtohtml</title>
        
            <meta property="og:title" content="Docxtohtml" />
        
    

    
        
            <meta property="og:description" content="基于python的Docx转Html操作" />
        
    

    
        
            <meta name="description" content="基于python的Docx转Html操作" />
        
    

    
        <link rel="icon" type="image/png" href="/icon/favicon.png" />
    

    
        
        <link rel="stylesheet" href="/sass/fonts.min.8631b5498d7736f82c926ea3193874edc64e922a34c30038c7c8368671494ea1.css" />
    

    

    
        <script src="/js/codeblock.js"></script>
    

    

    
        <script src="/js/note.js"></script>
    

    
        
            <script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };
            </script>
        
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    

    <link rel="alternate" type="application/atom+xml" title="hzzhu" href="/index.xml">

    
    
        
        
        <link rel="stylesheet" href="/sass/theme/light.min.edb28b5538eafa2e4e6cda9672e5fbb084ba7992cb6cb3e0674410fa10e51f22.css" />
        <link id="darkModeStyle" rel="stylesheet" href="/sass/theme/dark.min.c7a36ede12c4fa8139f2591d76d4972e30fc281264c6a60c06f3121d91e19d71.css" />
    

    
        <script src="/js/themetoggle.js"></script>
        
            <script>setTheme(getSavedTheme());</script>
        
    

    
    <link rel="stylesheet" href="/sass/main.min.b1515c6ec232b60ef38367cea9e6de123e7c4782770a8e3a69a63ef41646ceca.css" />

    

    
</head>

<body>
   <div class="content">
      
      <header>
    <div class="main">
        
            <a href="https://zhuzaiye.github.io/">hzzhu</a>
        

        <div class="socials">
            
                <a rel="me" href="https://github.com/zhuzaiye/" class="social">
                    <img alt="github" src="/icons/social/github.svg">
                </a>
            
                <a rel="me" href="mailto:hzzhu92@gmail.com" class="social">
                    <img alt="email" src="/icons/social/email.svg">
                </a>
            
                <a rel="me" href="https://twitter.com/pigzhu11" class="social">
                    <img alt="twitter" src="/icons/social/twitter.svg">
                </a>
            
                <a rel="me" href="/index.xml" class="social">
                    <img alt="rss" src="/icons/social/rss.svg">
                </a>
            
        </div>
    </div>

    <nav>
        
            <a href="/posts" style="margin-left: 0.25em">/posts</a>
        
            <a href="/projects" style="margin-left: 0.25em">/projects</a>
        
            <a href="/about" style="margin-left: 0.25em">/about</a>
        
        |
        
            <a id="dark-mode-toggle" onclick="toggleTheme(); event.preventDefault();" href="#">
                <img src="/icons/sun.svg" id="sun-icon" style="filter: invert(1)" alt="Light" />
                <img src="/icons/moon.svg" id="moon-icon" alt="Dark" />
            </a>
            
            
            <script>updateItemToggleTheme()</script>
        
    </nav>
</header>

      
      
    
    <main>
        <article>
            <div class="title">
                
    <div class="page-header">
        Docxtohtml<span class="primary-color" style="font-size: 1.6em">.</span>
    </div>


                <div class="meta">
                    Posted on <time>2022-07-03</time>
                    
                    
                    
                </div>
            </div>

            

            <section class="body">
                <p>由于工作中遇到<code>将office的word合并将合并的word转成Html5</code>的任务。</p>
<p>需要处理的相关问题如下：</p>
<ol>
<li>按照给定的excel将指定的多个word文档按照顺序合并</li>
<li>将合并后的word文档按照word中的字体、样式转化，并将word中的图片base64处理</li>
<li>将上述过程整理成一个简单小程序，如GUI程序，便于资源组直接进行处理</li>
</ol>
<h2 id="工具清单">工具清单</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Tool</th>
<th style="text-align:left">DESC</th>
<th style="text-align:left">Link</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">python=3.7</td>
<td style="text-align:left">base code</td>
<td style="text-align:left"><a href="https://docs.python.org/3.7/">https://docs.python.org/3.7/</a></td>
</tr>
<tr>
<td style="text-align:left">base64</td>
<td style="text-align:left">img base64转码</td>
<td style="text-align:left"><a href="https://docs.python.org/3.7/library/base64.html?highlight=base64#module-base64">https://docs.python.org/3.7/library/base64.html?highlight=base64#module-base64</a></td>
</tr>
<tr>
<td style="text-align:left">tkinter</td>
<td style="text-align:left">pyth0n GUI</td>
<td style="text-align:left"><a href="https://docs.python.org/3.7/library/tkinter.html?highlight=tkinter#module-tkinter">https://docs.python.org/3.7/library/tkinter.html?highlight=tkinter#module-tkinter</a></td>
</tr>
<tr>
<td style="text-align:left">docx=0.2.4</td>
<td style="text-align:left">加载word文档</td>
<td style="text-align:left"><a href="https://pypi.org/project/docx/">https://pypi.org/project/docx/</a></td>
</tr>
<tr>
<td style="text-align:left">docxcompose=1.3.4</td>
<td style="text-align:left">操作word文档</td>
<td style="text-align:left"><a href="https://pypi.org/project/docxcompose/">https://pypi.org/project/docxcompose/</a></td>
</tr>
<tr>
<td style="text-align:left">pywin32=304</td>
<td style="text-align:left">office的python宏调用包</td>
<td style="text-align:left"><a href="https://pypi.org/project/pywin32/">https://pypi.org/project/pywin32/</a></td>
</tr>
<tr>
<td style="text-align:left">lmxl=4.9.0</td>
<td style="text-align:left">解析html的包</td>
<td style="text-align:left"><a href="https://pypi.org/project/lxml/">https://pypi.org/project/lxml/</a></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! /usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># DESC：将docx转化成html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> shutil
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tkinter <span style="color:#66d9ef">as</span> tk
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tkinter <span style="color:#f92672">import</span> filedialog
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> win32com <span style="color:#f92672">import</span> client <span style="color:#66d9ef">as</span> wc
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> docx <span style="color:#f92672">import</span> Document
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> docxcompose.composer <span style="color:#f92672">import</span> Composer
</span></span></code></pre></div><h2 id="代码清单">代码清单</h2>
<h3 id="合并word文档主要针对docx">合并word文档[主要针对docx]</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">merge_doc</span>(docx_list: list, docx_tar: str, docx_list_src: str):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    docx_list: word文档名称列表 [&#34;word1.docx&#34;, &#34;word2.docx&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    docx_tar: 合并后word文档存储目标目录
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    docx_list_src: 需要合并word文档的源文件目录
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(docx_list) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 将第一个word文档作为合并基文档</span>
</span></span><span style="display:flex;"><span>    base_docx <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(docx_list_src, docx_list[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    tar_doc <span style="color:#f92672">=</span> Document(base_docx)
</span></span><span style="display:flex;"><span>    tar_composer <span style="color:#f92672">=</span> Composer(tar_doc)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 合并后续文档</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> next_doc <span style="color:#f92672">in</span> docx_list[<span style="color:#ae81ff">1</span>:]:
</span></span><span style="display:flex;"><span>        next_doc_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(docx_list_src, next_doc)
</span></span><span style="display:flex;"><span>        tar_composer<span style="color:#f92672">.</span>append(Document(next_doc_path))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 存储合并文档    </span>
</span></span><span style="display:flex;"><span>    docx_tar_file <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(docx_tar, <span style="color:#e6db74">&#34;introduce.docx&#34;</span>)
</span></span><span style="display:flex;"><span>    tar_composer<span style="color:#f92672">.</span>save(docx_tar_file)
</span></span></code></pre></div><h3 id="word文档转html">word文档转Html</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">convert_docx_html_pywin</span>(docx_file_path: str) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    docx_file_path: word原文档
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 调用windows的word的宏</span>
</span></span><span style="display:flex;"><span>    word <span style="color:#f92672">=</span> wc<span style="color:#f92672">.</span>Dispatch(<span style="color:#e6db74">&#39;Word.Application&#39;</span>)
</span></span><span style="display:flex;"><span>    doc <span style="color:#f92672">=</span> word<span style="color:#f92672">.</span>Documents<span style="color:#f92672">.</span>Open(docx_file_path)
</span></span><span style="display:flex;"><span>    html_file_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(docx_file_path),
</span></span><span style="display:flex;"><span>                                  os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>basename(docx_file_path)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;.&#34;</span>)[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.html&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 选择 10 单个另存为方式</span>
</span></span><span style="display:flex;"><span>    doc<span style="color:#f92672">.</span>SaveAs(html_file_path, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>    doc<span style="color:#f92672">.</span>Close()
</span></span><span style="display:flex;"><span>    word<span style="color:#f92672">.</span>Quit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 转化编码， 去掉byte编码转存utf8格式</span>
</span></span><span style="display:flex;"><span>    fp <span style="color:#f92672">=</span> open(html_file_path, <span style="color:#e6db74">&#34;rb&#34;</span>)
</span></span><span style="display:flex;"><span>    html_gb <span style="color:#f92672">=</span> fp<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    fp <span style="color:#f92672">=</span> open(html_file_path, <span style="color:#e6db74">&#34;wb&#34;</span>)
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>write(html_gb<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;gbk&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;charset=gb2312&#34;</span>, <span style="color:#e6db74">&#34;charset=utf-8&#34;</span>)<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> html_file_path
</span></span></code></pre></div><h3 id="将图片转成base64编码">将图片转成base64编码</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">convert_pic_base64</span>(img_path: str) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    img_path: 图片路径
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return： 返回base64编码串
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    fp <span style="color:#f92672">=</span> open(img_path, <span style="color:#e6db74">&#34;rb&#34;</span>)
</span></span><span style="display:flex;"><span>    img_content <span style="color:#f92672">=</span> fp<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    img_base64 <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64encode(img_content)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    img_base64_str <span style="color:#f92672">=</span> str(img_base64, <span style="color:#e6db74">&#34;utf-8&#34;</span>) <span style="color:#75715e"># b&#39;&#39; 转utf8字符串</span>
</span></span><span style="display:flex;"><span>    img_base64_tmp <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;data:image/</span><span style="color:#e6db74">{</span>os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>splitext(img_path)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>:]<span style="color:#e6db74">}</span><span style="color:#e6db74">;base64,</span><span style="color:#e6db74">{</span>img_base64_str<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> img_base64_tmp
</span></span></code></pre></div><h3 id="将转化后的html中的图片换成base64">将转化后的html中的图片换成base64</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_html_img_tag</span>(html_tar_file: str):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    html_tar_file: word转存html的原始文件
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 当前转化的图片路径</span>
</span></span><span style="display:flex;"><span>    dir_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(html_tar_file)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 将html中img的src进行修改</span>
</span></span><span style="display:flex;"><span>    html_content <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>parse(html_tar_file, etree<span style="color:#f92672">.</span>HTMLParser())
</span></span><span style="display:flex;"><span>    tmp_files <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> img_tag <span style="color:#f92672">in</span> html_content<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#34;//img&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> img_tag<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#34;src&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        src_img_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(dir_path, img_tag<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#34;src&#34;</span>])
</span></span><span style="display:flex;"><span>        tmp_files<span style="color:#f92672">.</span>append(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(src_img_path))
</span></span><span style="display:flex;"><span>        src_img_b64code <span style="color:#f92672">=</span> convert_pic_base64(src_img_path)
</span></span><span style="display:flex;"><span>        img_tag<span style="color:#f92672">.</span>attrib[<span style="color:#e6db74">&#34;src&#34;</span>] <span style="color:#f92672">=</span> src_img_b64code
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 去除转换后html中存在的system url和public id的信息</span>
</span></span><span style="display:flex;"><span>    html_content<span style="color:#f92672">.</span>docinfo<span style="color:#f92672">.</span>system_url <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    html_content<span style="color:#f92672">.</span>docinfo<span style="color:#f92672">.</span>public_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 将lxml处理后的字节html内容转存utf8的html文件</span>
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> open(html_tar_file, <span style="color:#e6db74">&#34;w&#34;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># method=html 去除非html的信息</span>
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(etree<span style="color:#f92672">.</span>tostring(html_content, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>, method<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;html&#34;</span>, pretty_print<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> tmp_files:
</span></span><span style="display:flex;"><span>        shutil<span style="color:#f92672">.</span>rmtree(p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># word转html总成</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">convert</span>(docx_path: str):
</span></span><span style="display:flex;"><span>    html_path <span style="color:#f92672">=</span> convert_docx_html_pywin(docx_path)
</span></span><span style="display:flex;"><span>    process_html_img_tag(html_path)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> html_path<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;/&#34;</span>)
</span></span></code></pre></div><h3 id="基于tkinter的简单gui设计">基于tkinter的简单GUI设计</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>window <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>Tk()
</span></span><span style="display:flex;"><span>window<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Word转Html工具&#34;</span>)
</span></span><span style="display:flex;"><span>window<span style="color:#f92672">.</span>geometry(<span style="color:#e6db74">&#39;600x300&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置输入 1 2</span>
</span></span><span style="display:flex;"><span>path_var <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>StringVar()
</span></span><span style="display:flex;"><span>entry <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>Entry(window, textvariable<span style="color:#f92672">=</span>path_var, width<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>entry<span style="color:#f92672">.</span>place(x<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, anchor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>path_var1 <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>StringVar()
</span></span><span style="display:flex;"><span>entry1 <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>Entry(window, textvariable<span style="color:#f92672">=</span>path_var1, width<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>entry1<span style="color:#f92672">.</span>place(x<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, anchor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">choose_file_click</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    选择文件事件定义
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 设置可以选择的文件类型，不属于这个类型的，无法被选中</span>
</span></span><span style="display:flex;"><span>    file_types <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#34;word文件&#34;</span>, <span style="color:#e6db74">&#34;*.docx&#34;</span>)]
</span></span><span style="display:flex;"><span>    file_name <span style="color:#f92672">=</span> filedialog<span style="color:#f92672">.</span>askopenfilename(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;选择单个文件&#39;</span>,
</span></span><span style="display:flex;"><span>                                           filetypes<span style="color:#f92672">=</span>file_types,
</span></span><span style="display:flex;"><span>                                           initialdir<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;./&#39;</span>)  <span style="color:#75715e"># 打开当前程序工作目录</span>
</span></span><span style="display:flex;"><span>    path_var<span style="color:#f92672">.</span>set(file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">convert_file_click</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    word转html事件定义
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    src_file_path <span style="color:#f92672">=</span> path_var<span style="color:#f92672">.</span>get()
</span></span><span style="display:flex;"><span>    convert_fil_path <span style="color:#f92672">=</span> convert(src_file_path)
</span></span><span style="display:flex;"><span>    path_var1<span style="color:#f92672">.</span>set(convert_fil_path)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">clear_clik</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    清空所有事件定义
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    path_var<span style="color:#f92672">.</span>set(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    path_var1<span style="color:#f92672">.</span>set(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>choose_btn <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>Button(window, text<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;选择&#39;</span>, command<span style="color:#f92672">=</span>choose_file_click)
</span></span><span style="display:flex;"><span>choose_btn<span style="color:#f92672">.</span>place(x<span style="color:#f92672">=</span><span style="color:#ae81ff">450</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, anchor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>convert_btn <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>Button(window, text<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;转化&#39;</span>, command<span style="color:#f92672">=</span>convert_file_click)
</span></span><span style="display:flex;"><span>convert_btn<span style="color:#f92672">.</span>place(x<span style="color:#f92672">=</span><span style="color:#ae81ff">450</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, anchor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>clear_btn <span style="color:#f92672">=</span> tk<span style="color:#f92672">.</span>Button(window, text<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;清空&#39;</span>, command<span style="color:#f92672">=</span>clear_clik)
</span></span><span style="display:flex;"><span>clear_btn<span style="color:#f92672">.</span>place(x<span style="color:#f92672">=</span><span style="color:#ae81ff">450</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, anchor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>window<span style="color:#f92672">.</span>mainloop()
</span></span></code></pre></div><h2 id="word合并以及转html测试">word合并以及转html测试</h2>
<h3 id="word合并效果"><strong><code>word合并</code>效果</strong></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    docs <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;xx.docx&#34;</span>, <span style="color:#e6db74">&#34;yy.docx&#34;</span>]
</span></span><span style="display:flex;"><span>    tar <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    src <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    merge_doc(docs, tar, src)
</span></span></code></pre></div><p><img src="/img/blog/word2html_docx.png" alt="word docx src 1">
<img src="/img/blog/word2html_docx_2.png" alt="word docx src 2">
<img src="/img/blog/word2html_merge_rst.png" alt="word docx merge result"></p>
<p><code>合并效果中/docx 2/中字体样式存在部分合并失效。目前未有很好的解决方法。</code></p>
<p><code>如果您有好的解决办法，请留言，不胜感激！！</code></p>
<h3 id="docx转html效果"><strong><code>docx转html效果</code></strong></h3>
<p><img src="/img/blog/word2html_docx.png" alt="word docx"></p>
<ul>
<li><strong><code>docx转化后的html文件</code></strong></li>
</ul>
<p><img src="/img/blog/word2html_html.png" alt="converted html result"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;MsoNormal&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-align:justify;text-justify:inter-ideograph;line-height:normal&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;font-size:10.5pt;font-family:&#34;Rounded Mplus 1c&#34;&#39;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;601&#34;</span> <span style="color:#a6e22e">height</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;159&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;image1.png&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;data:image/gif;base64,R0lGODlhWQKfAHcAMSH...+GcAQEAOw==&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">p</span>&gt;
</span></span></code></pre></div><h3 id="gui效果以及测试"><strong><code>GUI</code>效果以及测试</strong></h3>
<p><img src="/img/blog/word2html_gui.png" alt="gui start result">
<img src="/img/blog/word2html_gui_rst.png" alt="gui worked result"></p>

            </section>
        </article>
    </main>



      <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk@1.2.2/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2022-07-03 23:21:04 \u002b0800 CST',
        title: 'Docxtohtml',
        clientID: '9c36634fbb845c1d1d64',
        clientSecret: '3d57254b5ffccf04f9d973cc42b1d84ecd48fd01',
        repo: 'zhuzaiye.github.io',
        owner: 'zhuzaiye',
        admin: ['zhuzaiye'],
        body: decodeURI(location.href),
        language: "en"
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>


   </div>
</body>

</html>