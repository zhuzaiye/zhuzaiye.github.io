
<!DOCTYPE html>
<html lang="en" class="dark light">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https://zhuzaiye.github.io/">

    
    

    
    
        <title>Docxtohtml</title>
        
            <meta property="og:title" content="Docxtohtml" />
        
    

    
        
            <meta property="og:description" content="基于python的Docx转Html操作" />
        
    

    
        
            <meta name="description" content="基于python的Docx转Html操作" />
        
    

    
    

    
    

    
    

    
    
        
        <script src="https://zhuzaiye.github.io/js/main.min.709b2cc07788dc81af71cdb44ac921361de4570bb2f7a9ac753efa35798fda5c.js" integrity="sha256-cJsswHeI3IGvcc20SskhNh3kVwuy96msdT76NXmP2lw=" defer></script>
    

    
    

    
    
        
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    

    <link rel="alternate" type="application/atom+xml" title="hzzhu" href="/index.xml">

    
    
    
    

    
        <link rel="stylesheet" href="/sass/theme/light.min.7bebe62a7f0bce52d5ac022ed2f94faa37a1771a19e0e45897652b4bb6aa90a9.css" />
        <link id="darkModeStyle" rel="stylesheet" href="/sass/theme/dark.min.3dc265de402f27bbd2bdc27f57ddc5be9ac23d9a1e5395858431e8bf42dde643.css" />
    

    

    
    
        
        <link rel="stylesheet" href="/sass/main.min.4e80c49d3ae342a2393ad84fd49c4a7dddc5df307e7f7a75562b7dfba62a3bb7.css" />
    

    
    

    
    
</head>


<body>
   <div class="page-wrapper">
      <div class="page-container">
         <div class="main-content">
            
            <header>
    <div class="main">
        
        <a href="https://zhuzaiye.github.io/">hzzhu</a>
        

        <div class="socials">
            
            <a rel="me" href="https://github.com/zhuzaiye/" class="social">
                <img alt="github" src="/icons/social/github.svg">
            </a>
            
            <a rel="me" href="mailto:hzzhu92@gmail.com" class="social">
                <img alt="email" src="/icons/social/email.svg">
            </a>
            
            <a rel="me" href="https://twitter.com/pigzhu11" class="social">
                <img alt="twitter" src="/icons/social/twitter.svg">
            </a>
            
            <a rel="me" href="/index.xml" class="social">
                <img alt="rss" src="/icons/social/rss.svg">
            </a>
            
        </div>
    </div>

    <nav>
        
        <a href="/posts" style="margin-left: 0.25em">/posts</a>
        
        <a href="/projects" style="margin-left: 0.25em">/projects</a>
        
        <a href="/about" style="margin-left: 0.25em">/about</a>
        
        <a href="/notes" style="margin-left: 0.25em">/notes</a>
        
        |
        
        <a id="dark-mode-toggle" onclick="toggleTheme(); return false;" href="#">
            <img src="/icons/sun.svg" id="sun-icon" style="filter: invert(1)" alt="Light" />
            <img src="/icons/moon.svg" id="moon-icon" alt="Dark" />
        </a>
        
    </nav>
</header>

            
            
<article class="post-single">
    
    <header class="post-header">
        
        <h1 class="post-title">Docxtohtml</h1>
        
        
        <div class="post-meta">
            
            
            <div class="post-date">
                <time datetime="2022-07-03T23:21:04&#43;08:00">
                    July 3, 2022
                </time>
            </div>
            
            
            
            
            
            
            
            <div class="post-description">
                基于python的Docx转Html操作
            </div>
            
        </div>
    </header>

    
    <div class="post-content">
        <p>由于工作中遇到<code>将office的word合并将合并的word转成Html5</code>的任务。</p>
<p>需要处理的相关问题如下：</p>
<ol>
<li>按照给定的excel将指定的多个word文档按照顺序合并</li>
<li>将合并后的word文档按照word中的字体、样式转化，并将word中的图片base64处理</li>
<li>将上述过程整理成一个简单小程序，如GUI程序，便于资源组直接进行处理</li>
</ol>
<h2 id="工具清单">工具清单</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Tool</th>
          <th style="text-align: left">DESC</th>
          <th style="text-align: left">Link</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">python=3.7</td>
          <td style="text-align: left">base code</td>
          <td style="text-align: left"><a href="https://docs.python.org/3.7/">https://docs.python.org/3.7/</a></td>
      </tr>
      <tr>
          <td style="text-align: left">base64</td>
          <td style="text-align: left">img base64转码</td>
          <td style="text-align: left"><a href="https://docs.python.org/3.7/library/base64.html?highlight=base64#module-base64">https://docs.python.org/3.7/library/base64.html?highlight=base64#module-base64</a></td>
      </tr>
      <tr>
          <td style="text-align: left">tkinter</td>
          <td style="text-align: left">pyth0n GUI</td>
          <td style="text-align: left"><a href="https://docs.python.org/3.7/library/tkinter.html?highlight=tkinter#module-tkinter">https://docs.python.org/3.7/library/tkinter.html?highlight=tkinter#module-tkinter</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docx=0.2.4</td>
          <td style="text-align: left">加载word文档</td>
          <td style="text-align: left"><a href="https://pypi.org/project/docx/">https://pypi.org/project/docx/</a></td>
      </tr>
      <tr>
          <td style="text-align: left">docxcompose=1.3.4</td>
          <td style="text-align: left">操作word文档</td>
          <td style="text-align: left"><a href="https://pypi.org/project/docxcompose/">https://pypi.org/project/docxcompose/</a></td>
      </tr>
      <tr>
          <td style="text-align: left">pywin32=304</td>
          <td style="text-align: left">office的python宏调用包</td>
          <td style="text-align: left"><a href="https://pypi.org/project/pywin32/">https://pypi.org/project/pywin32/</a></td>
      </tr>
      <tr>
          <td style="text-align: left">lmxl=4.9.0</td>
          <td style="text-align: left">解析html的包</td>
          <td style="text-align: left"><a href="https://pypi.org/project/lxml/">https://pypi.org/project/lxml/</a></td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4">#! /usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># DESC：将docx转化成html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> base64
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> shutil
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> tkinter <span style="color:#ff79c6">as</span> tk
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> tkinter <span style="color:#ff79c6">import</span> filedialog
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> lxml <span style="color:#ff79c6">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> win32com <span style="color:#ff79c6">import</span> client <span style="color:#ff79c6">as</span> wc
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> docx <span style="color:#ff79c6">import</span> Document
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> docxcompose.composer <span style="color:#ff79c6">import</span> Composer
</span></span></code></pre></div><h2 id="代码清单">代码清单</h2>
<h3 id="合并word文档主要针对docx">合并word文档[主要针对docx]</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">merge_doc</span>(docx_list: <span style="color:#8be9fd;font-style:italic">list</span>, docx_tar: <span style="color:#8be9fd;font-style:italic">str</span>, docx_list_src: <span style="color:#8be9fd;font-style:italic">str</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    docx_list: word文档名称列表 [&#34;word1.docx&#34;, &#34;word2.docx&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    docx_tar: 合并后word文档存储目标目录
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    docx_list_src: 需要合并word文档的源文件目录
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#8be9fd;font-style:italic">len</span>(docx_list) <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 将第一个word文档作为合并基文档</span>
</span></span><span style="display:flex;"><span>    base_docx <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(docx_list_src, docx_list[<span style="color:#bd93f9">0</span>])
</span></span><span style="display:flex;"><span>    tar_doc <span style="color:#ff79c6">=</span> Document(base_docx)
</span></span><span style="display:flex;"><span>    tar_composer <span style="color:#ff79c6">=</span> Composer(tar_doc)
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 合并后续文档</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> next_doc <span style="color:#ff79c6">in</span> docx_list[<span style="color:#bd93f9">1</span>:]:
</span></span><span style="display:flex;"><span>        next_doc_path <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(docx_list_src, next_doc)
</span></span><span style="display:flex;"><span>        tar_composer<span style="color:#ff79c6">.</span>append(Document(next_doc_path))
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 存储合并文档    </span>
</span></span><span style="display:flex;"><span>    docx_tar_file <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(docx_tar, <span style="color:#f1fa8c">&#34;introduce.docx&#34;</span>)
</span></span><span style="display:flex;"><span>    tar_composer<span style="color:#ff79c6">.</span>save(docx_tar_file)
</span></span></code></pre></div><h3 id="word文档转html">word文档转Html</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">convert_docx_html_pywin</span>(docx_file_path: <span style="color:#8be9fd;font-style:italic">str</span>) <span style="color:#ff79c6">-&gt;</span> <span style="color:#8be9fd;font-style:italic">str</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    docx_file_path: word原文档
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 调用windows的word的宏</span>
</span></span><span style="display:flex;"><span>    word <span style="color:#ff79c6">=</span> wc<span style="color:#ff79c6">.</span>Dispatch(<span style="color:#f1fa8c">&#39;Word.Application&#39;</span>)
</span></span><span style="display:flex;"><span>    doc <span style="color:#ff79c6">=</span> word<span style="color:#ff79c6">.</span>Documents<span style="color:#ff79c6">.</span>Open(docx_file_path)
</span></span><span style="display:flex;"><span>    html_file_path <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>dirname(docx_file_path),
</span></span><span style="display:flex;"><span>                                  os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>basename(docx_file_path)<span style="color:#ff79c6">.</span>split(<span style="color:#f1fa8c">&#34;.&#34;</span>)[<span style="color:#bd93f9">0</span>] <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;.html&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 选择 10 单个另存为方式</span>
</span></span><span style="display:flex;"><span>    doc<span style="color:#ff79c6">.</span>SaveAs(html_file_path, <span style="color:#bd93f9">10</span>)
</span></span><span style="display:flex;"><span>    doc<span style="color:#ff79c6">.</span>Close()
</span></span><span style="display:flex;"><span>    word<span style="color:#ff79c6">.</span>Quit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 转化编码， 去掉byte编码转存utf8格式</span>
</span></span><span style="display:flex;"><span>    fp <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(html_file_path, <span style="color:#f1fa8c">&#34;rb&#34;</span>)
</span></span><span style="display:flex;"><span>    html_gb <span style="color:#ff79c6">=</span> fp<span style="color:#ff79c6">.</span>read()
</span></span><span style="display:flex;"><span>    fp<span style="color:#ff79c6">.</span>close()
</span></span><span style="display:flex;"><span>    fp <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(html_file_path, <span style="color:#f1fa8c">&#34;wb&#34;</span>)
</span></span><span style="display:flex;"><span>    fp<span style="color:#ff79c6">.</span>write(html_gb<span style="color:#ff79c6">.</span>decode(<span style="color:#f1fa8c">&#34;gbk&#34;</span>)<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;charset=gb2312&#34;</span>, <span style="color:#f1fa8c">&#34;charset=utf-8&#34;</span>)<span style="color:#ff79c6">.</span>encode(<span style="color:#f1fa8c">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>    fp<span style="color:#ff79c6">.</span>close()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> html_file_path
</span></span></code></pre></div><h3 id="将图片转成base64编码">将图片转成base64编码</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">convert_pic_base64</span>(img_path: <span style="color:#8be9fd;font-style:italic">str</span>) <span style="color:#ff79c6">-&gt;</span> <span style="color:#8be9fd;font-style:italic">str</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    img_path: 图片路径
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    return： 返回base64编码串
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    fp <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(img_path, <span style="color:#f1fa8c">&#34;rb&#34;</span>)
</span></span><span style="display:flex;"><span>    img_content <span style="color:#ff79c6">=</span> fp<span style="color:#ff79c6">.</span>read()
</span></span><span style="display:flex;"><span>    img_base64 <span style="color:#ff79c6">=</span> base64<span style="color:#ff79c6">.</span>b64encode(img_content)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    img_base64_str <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(img_base64, <span style="color:#f1fa8c">&#34;utf-8&#34;</span>) <span style="color:#6272a4"># b&#39;&#39; 转utf8字符串</span>
</span></span><span style="display:flex;"><span>    img_base64_tmp <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34;data:image/</span><span style="color:#f1fa8c">{</span>os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>splitext(img_path)[<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>][<span style="color:#bd93f9">1</span>:]<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">;base64,</span><span style="color:#f1fa8c">{</span>img_base64_str<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> img_base64_tmp
</span></span></code></pre></div><h3 id="将转化后的html中的图片换成base64">将转化后的html中的图片换成base64</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">process_html_img_tag</span>(html_tar_file: <span style="color:#8be9fd;font-style:italic">str</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    html_tar_file: word转存html的原始文件
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 当前转化的图片路径</span>
</span></span><span style="display:flex;"><span>    dir_path <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>dirname(html_tar_file)
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 将html中img的src进行修改</span>
</span></span><span style="display:flex;"><span>    html_content <span style="color:#ff79c6">=</span> etree<span style="color:#ff79c6">.</span>parse(html_tar_file, etree<span style="color:#ff79c6">.</span>HTMLParser())
</span></span><span style="display:flex;"><span>    tmp_files <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> img_tag <span style="color:#ff79c6">in</span> html_content<span style="color:#ff79c6">.</span>xpath(<span style="color:#f1fa8c">&#34;//img&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> img_tag<span style="color:#ff79c6">.</span>attrib[<span style="color:#f1fa8c">&#34;src&#34;</span>] <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;&#34;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">continue</span>
</span></span><span style="display:flex;"><span>        src_img_path <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(dir_path, img_tag<span style="color:#ff79c6">.</span>attrib[<span style="color:#f1fa8c">&#34;src&#34;</span>])
</span></span><span style="display:flex;"><span>        tmp_files<span style="color:#ff79c6">.</span>append(os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>dirname(src_img_path))
</span></span><span style="display:flex;"><span>        src_img_b64code <span style="color:#ff79c6">=</span> convert_pic_base64(src_img_path)
</span></span><span style="display:flex;"><span>        img_tag<span style="color:#ff79c6">.</span>attrib[<span style="color:#f1fa8c">&#34;src&#34;</span>] <span style="color:#ff79c6">=</span> src_img_b64code
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 去除转换后html中存在的system url和public id的信息</span>
</span></span><span style="display:flex;"><span>    html_content<span style="color:#ff79c6">.</span>docinfo<span style="color:#ff79c6">.</span>system_url <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">None</span>
</span></span><span style="display:flex;"><span>    html_content<span style="color:#ff79c6">.</span>docinfo<span style="color:#ff79c6">.</span>public_id <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">None</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 将lxml处理后的字节html内容转存utf8的html文件</span>
</span></span><span style="display:flex;"><span>    f <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(html_tar_file, <span style="color:#f1fa8c">&#34;w&#34;</span>, encoding<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;utf-8&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># method=html 去除非html的信息</span>
</span></span><span style="display:flex;"><span>    f<span style="color:#ff79c6">.</span>write(etree<span style="color:#ff79c6">.</span>tostring(html_content, encoding<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;utf-8&#34;</span>, method<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;html&#34;</span>, pretty_print<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>)<span style="color:#ff79c6">.</span>decode(<span style="color:#f1fa8c">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>    f<span style="color:#ff79c6">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> p <span style="color:#ff79c6">in</span> tmp_files:
</span></span><span style="display:flex;"><span>        shutil<span style="color:#ff79c6">.</span>rmtree(p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># word转html总成</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">convert</span>(docx_path: <span style="color:#8be9fd;font-style:italic">str</span>):
</span></span><span style="display:flex;"><span>    html_path <span style="color:#ff79c6">=</span> convert_docx_html_pywin(docx_path)
</span></span><span style="display:flex;"><span>    process_html_img_tag(html_path)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> html_path<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\\</span><span style="color:#f1fa8c">&#34;</span>, <span style="color:#f1fa8c">&#34;/&#34;</span>)
</span></span></code></pre></div><h3 id="基于tkinter的简单gui设计">基于tkinter的简单GUI设计</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>window <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>Tk()
</span></span><span style="display:flex;"><span>window<span style="color:#ff79c6">.</span>title(<span style="color:#f1fa8c">&#34;Word转Html工具&#34;</span>)
</span></span><span style="display:flex;"><span>window<span style="color:#ff79c6">.</span>geometry(<span style="color:#f1fa8c">&#39;600x300&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># 设置输入 1 2</span>
</span></span><span style="display:flex;"><span>path_var <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>StringVar()
</span></span><span style="display:flex;"><span>entry <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>Entry(window, textvariable<span style="color:#ff79c6">=</span>path_var, width<span style="color:#ff79c6">=</span><span style="color:#bd93f9">60</span>)
</span></span><span style="display:flex;"><span>entry<span style="color:#ff79c6">.</span>place(x<span style="color:#ff79c6">=</span><span style="color:#bd93f9">20</span>, y<span style="color:#ff79c6">=</span><span style="color:#bd93f9">10</span>, anchor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>path_var1 <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>StringVar()
</span></span><span style="display:flex;"><span>entry1 <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>Entry(window, textvariable<span style="color:#ff79c6">=</span>path_var1, width<span style="color:#ff79c6">=</span><span style="color:#bd93f9">60</span>)
</span></span><span style="display:flex;"><span>entry1<span style="color:#ff79c6">.</span>place(x<span style="color:#ff79c6">=</span><span style="color:#bd93f9">20</span>, y<span style="color:#ff79c6">=</span><span style="color:#bd93f9">60</span>, anchor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">choose_file_click</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    选择文件事件定义
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># 设置可以选择的文件类型，不属于这个类型的，无法被选中</span>
</span></span><span style="display:flex;"><span>    file_types <span style="color:#ff79c6">=</span> [(<span style="color:#f1fa8c">&#34;word文件&#34;</span>, <span style="color:#f1fa8c">&#34;*.docx&#34;</span>)]
</span></span><span style="display:flex;"><span>    file_name <span style="color:#ff79c6">=</span> filedialog<span style="color:#ff79c6">.</span>askopenfilename(title<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;选择单个文件&#39;</span>,
</span></span><span style="display:flex;"><span>                                           filetypes<span style="color:#ff79c6">=</span>file_types,
</span></span><span style="display:flex;"><span>                                           initialdir<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;./&#39;</span>)  <span style="color:#6272a4"># 打开当前程序工作目录</span>
</span></span><span style="display:flex;"><span>    path_var<span style="color:#ff79c6">.</span>set(file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">convert_file_click</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    word转html事件定义
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    src_file_path <span style="color:#ff79c6">=</span> path_var<span style="color:#ff79c6">.</span>get()
</span></span><span style="display:flex;"><span>    convert_fil_path <span style="color:#ff79c6">=</span> convert(src_file_path)
</span></span><span style="display:flex;"><span>    path_var1<span style="color:#ff79c6">.</span>set(convert_fil_path)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">clear_clik</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    清空所有事件定义
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    path_var<span style="color:#ff79c6">.</span>set(<span style="color:#f1fa8c">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    path_var1<span style="color:#ff79c6">.</span>set(<span style="color:#f1fa8c">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>choose_btn <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>Button(window, text<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;选择&#39;</span>, command<span style="color:#ff79c6">=</span>choose_file_click)
</span></span><span style="display:flex;"><span>choose_btn<span style="color:#ff79c6">.</span>place(x<span style="color:#ff79c6">=</span><span style="color:#bd93f9">450</span>, y<span style="color:#ff79c6">=</span><span style="color:#bd93f9">10</span>, anchor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>convert_btn <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>Button(window, text<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;转化&#39;</span>, command<span style="color:#ff79c6">=</span>convert_file_click)
</span></span><span style="display:flex;"><span>convert_btn<span style="color:#ff79c6">.</span>place(x<span style="color:#ff79c6">=</span><span style="color:#bd93f9">450</span>, y<span style="color:#ff79c6">=</span><span style="color:#bd93f9">60</span>, anchor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>clear_btn <span style="color:#ff79c6">=</span> tk<span style="color:#ff79c6">.</span>Button(window, text<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;清空&#39;</span>, command<span style="color:#ff79c6">=</span>clear_clik)
</span></span><span style="display:flex;"><span>clear_btn<span style="color:#ff79c6">.</span>place(x<span style="color:#ff79c6">=</span><span style="color:#bd93f9">450</span>, y<span style="color:#ff79c6">=</span><span style="color:#bd93f9">100</span>, anchor<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;nw&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>window<span style="color:#ff79c6">.</span>mainloop()
</span></span></code></pre></div><h2 id="word合并以及转html测试">word合并以及转html测试</h2>
<h3 id="word合并"><strong><code>word合并</code>效果</strong></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">if</span> <span style="color:#8be9fd;font-style:italic">__name__</span> <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    docs <span style="color:#ff79c6">=</span> [<span style="color:#f1fa8c">&#34;xx.docx&#34;</span>, <span style="color:#f1fa8c">&#34;yy.docx&#34;</span>]
</span></span><span style="display:flex;"><span>    tar <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">r</span><span style="color:#f1fa8c">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    src <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">r</span><span style="color:#f1fa8c">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    merge_doc(docs, tar, src)
</span></span></code></pre></div><p><img src="/imgs//word2html_docx.png" alt="word docx src 1">
<img src="/imgs//word2html_docx_2.png" alt="word docx src 2">
<img src="/imgs//word2html_merge_rst.png" alt="word docx merge result"></p>
<p><code>合并效果中/docx 2/中字体样式存在部分合并失效。目前未有很好的解决方法。</code></p>
<p><code>如果您有好的解决办法，请留言，不胜感激！！</code></p>
<h3 id="docx转html效果"><strong><code>docx转html效果</code></strong></h3>
<p><img src="/imgs//word2html_docx.png" alt="word docx"></p>
<ul>
<li><strong><code>docx转化后的html文件</code></strong></li>
</ul>
<p><img src="/imgs//word2html_html.png" alt="converted html result"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">p</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;MsoNormal&#34;</span> <span style="color:#50fa7b">style</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text-align:justify;text-justify:inter-ideograph;line-height:normal&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">span</span> <span style="color:#50fa7b">style</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;font-size:10.5pt;font-family:&#34;Rounded Mplus 1c&#34;&#39;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#ff79c6">img</span> <span style="color:#50fa7b">width</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;601&#34;</span> <span style="color:#50fa7b">height</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;159&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;image1.png&#34;</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;data:image/gif;base64,R0lGODlhWQKfAHcAMSH...+GcAQEAOw==&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#ff79c6">span</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">p</span>&gt;
</span></span></code></pre></div><h3 id="gui"><strong><code>GUI</code>效果以及测试</strong></h3>
<p><img src="/imgs//word2html_gui.png" alt="gui start result">
<img src="/imgs//word2html_gui_rst.png" alt="gui worked result"></p>

    </div>
</article>


<aside class="toc-sidebar">
    <div class="toc-sticky">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#工具清单">工具清单</a></li>
    <li><a href="#代码清单">代码清单</a>
      <ul>
        <li><a href="#合并word文档主要针对docx">合并word文档[主要针对docx]</a></li>
        <li><a href="#word文档转html">word文档转Html</a></li>
        <li><a href="#将图片转成base64编码">将图片转成base64编码</a></li>
        <li><a href="#将转化后的html中的图片换成base64">将转化后的html中的图片换成base64</a></li>
        <li><a href="#基于tkinter的简单gui设计">基于tkinter的简单GUI设计</a></li>
      </ul>
    </li>
    <li><a href="#word合并以及转html测试">word合并以及转html测试</a>
      <ul>
        <li><a href="#word合并"><strong><code>word合并</code>效果</strong></a></li>
        <li><a href="#docx转html效果"><strong><code>docx转html效果</code></strong></a></li>
        <li><a href="#gui"><strong><code>GUI</code>效果以及测试</strong></a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</aside>



            <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk@1.2.2/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2022-07-03 23:21:04 \u002b0800 CST',
        title: 'Docxtohtml',
        clientID: '9c36634fbb845c1d1d64',
        clientSecret: '3d57254b5ffccf04f9d973cc42b1d84ecd48fd01',
        repo: 'zhuzaiye.github.io',
        owner: 'zhuzaiye',
        admin: ['zhuzaiye'],
        body: decodeURI(location.href),
        language: "en"
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>

         </div>
      </div>
   </div>
</body>

</html>